name: CI

on: [ push, pull_request ]

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      CI: 1

    steps:
      - uses: actions/checkout@v2
      - uses: php-actions/composer@v5

      - name: Add German locale
        run: sudo locale-gen de_DE

      - name: Add Spanish locale
        run: sudo locale-gen es_ES

      - name: Tmp dir permissions
        run: chmod -R 777 ./app/tmp

      - name: Composer install
        with:
          php_version: 7.3
          version: 2
          run: composer install --prefer-dist

      - name: Run PHPUnit (7.3)
        with:
          php_version: 7.3
          run: php vendor/bin/phpunit

      - name: Run PHPUnit (7.4)
        with:
          php_version: 7.4
          run: php vendor/bin/phpunit
