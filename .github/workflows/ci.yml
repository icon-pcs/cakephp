name: CI

on: [push, pull_request]

jobs:
  build:
    runs-on: ubuntu-latest

    env:
      CI: 1

    steps:
      - uses: actions/checkout@v1

      - name: Add German locale
        run: sudo locale-gen de_DE

      - name: Add Spanish locale
        run: sudo locale-gen es_ES

      - name: Tmp dir permissions
        run: chmod -R 777 ./app/tmp

      - name: Composer install
        run: composer install --prefer-dist --ignore-platform-reqs

      - name: Run PHPUnit (7.3)
        run: php7.3 vendor/bin/phpunit

      - name: Run PHPUnit (7.4)
        run: php7.4 vendor/bin/phpunit
